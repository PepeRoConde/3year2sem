
Running with the following configuration:
Root directory: /Users/pepe/carrera/3/2/vca/practicas/p2
Data Augmentation: True
Docked classification: True
Not training model: False
Training data ratio: 0.8
Pretrained: True
Model path: modelParams
Loading pretrained model: False
Class balancing: Balanced
Batch size: 16
Number of workers: 8
Number of epochs: 200
Early stopping patience: 8
Learning rate: 0.0001
L2 regularization lambda: 0.0
Learning rate decay patience: 4
Test images: []


--
Class counts before balancing: Counter({2: 151, 1: 144, 0: 88})
weights for balancing: Counter({0.006622516556291391: 151, 0.006944444444444444: 144, 0.011363636363636364: 88})
--

Using device: MPS
Epoch 1/200
----------
  Batch 0: Loss: 1.1027, Acc: 0.2500
  Batch 20: Loss: 1.0562, Acc: 0.3750
  Train Loss: 1.0684 Acc: 0.4935
Epoch 2/200
----------
  Batch 0: Loss: 1.0953, Acc: 0.3125
  Batch 20: Loss: 0.9888, Acc: 0.7500
  Train Loss: 1.0100 Acc: 0.6031
Epoch 3/200
----------
  Batch 0: Loss: 0.9091, Acc: 0.8750
  Batch 20: Loss: 0.9295, Acc: 0.6250
  Train Loss: 0.9313 Acc: 0.7102
Epoch 4/200
----------
  Batch 0: Loss: 0.8884, Acc: 0.8125
  Batch 20: Loss: 0.8423, Acc: 0.6875
  Train Loss: 0.8581 Acc: 0.7650
Epoch 5/200
----------
  Batch 0: Loss: 0.8646, Acc: 0.7500
  Batch 20: Loss: 0.8510, Acc: 0.6875
  Train Loss: 0.7954 Acc: 0.8016
Epoch 6/200
----------
  Batch 0: Loss: 0.7915, Acc: 0.7500
  Batch 20: Loss: 0.7423, Acc: 0.8750
  Train Loss: 0.7614 Acc: 0.8225
Epoch 7/200
----------
  Batch 0: Loss: 0.7126, Acc: 0.9375
  Batch 20: Loss: 0.6791, Acc: 0.9375
  Train Loss: 0.7283 Acc: 0.8564
Epoch 8/200
----------
  Batch 0: Loss: 0.6936, Acc: 0.8750
  Batch 20: Loss: 0.7800, Acc: 0.8125
  Train Loss: 0.6919 Acc: 0.8799
Epoch 9/200
----------
  Batch 0: Loss: 0.6778, Acc: 0.8750
  Batch 20: Loss: 0.6665, Acc: 0.8750
  Train Loss: 0.6793 Acc: 0.8851
Epoch 10/200
----------
  Batch 0: Loss: 0.7289, Acc: 0.8125
  Batch 20: Loss: 0.7470, Acc: 0.8125
  Train Loss: 0.6847 Acc: 0.8851
  No improvement in loss for 1 epochs.
Epoch 11/200
----------
  Batch 0: Loss: 0.6695, Acc: 0.9375
  Batch 20: Loss: 0.6979, Acc: 0.8750
  Train Loss: 0.6831 Acc: 0.8930
  No improvement in loss for 2 epochs.
Epoch 12/200
----------
  Batch 0: Loss: 0.6844, Acc: 0.8750
  Batch 20: Loss: 0.6876, Acc: 0.8750
  Train Loss: 0.6687 Acc: 0.8877
Epoch 13/200
----------
  Batch 0: Loss: 0.7285, Acc: 0.8125
  Batch 20: Loss: 0.7170, Acc: 0.8750
  Train Loss: 0.6804 Acc: 0.8747
  No improvement in loss for 1 epochs.
Epoch 14/200
----------
  Batch 0: Loss: 0.6546, Acc: 0.8750
  Batch 20: Loss: 0.5717, Acc: 1.0000
  Train Loss: 0.6811 Acc: 0.8825
  No improvement in loss for 2 epochs.
Epoch 15/200
----------
  Batch 0: Loss: 0.6093, Acc: 0.9375
  Batch 20: Loss: 0.5795, Acc: 1.0000
  Train Loss: 0.6386 Acc: 0.9269
Epoch 16/200
----------
  Batch 0: Loss: 0.6172, Acc: 0.9375
  Batch 20: Loss: 0.6835, Acc: 0.8750
  Train Loss: 0.6456 Acc: 0.9164
  No improvement in loss for 1 epochs.
Epoch 17/200
----------
  Batch 0: Loss: 0.5660, Acc: 1.0000
  Batch 20: Loss: 0.5548, Acc: 1.0000
  Train Loss: 0.6419 Acc: 0.9060
  No improvement in loss for 2 epochs.
Epoch 18/200
----------
  Batch 0: Loss: 0.6152, Acc: 0.9375
  Batch 20: Loss: 0.6248, Acc: 0.9375
  Train Loss: 0.6459 Acc: 0.9086
  No improvement in loss for 3 epochs.
Epoch 19/200
----------
  Batch 0: Loss: 0.6981, Acc: 0.8750
  Batch 20: Loss: 0.6608, Acc: 0.8750
  Train Loss: 0.6373 Acc: 0.9164
Epoch 20/200
----------
  Batch 0: Loss: 0.6383, Acc: 0.9375
  Batch 20: Loss: 0.6336, Acc: 0.9375
  Train Loss: 0.6360 Acc: 0.9269
Epoch 21/200
----------
  Batch 0: Loss: 0.6323, Acc: 0.9375
  Batch 20: Loss: 0.5905, Acc: 1.0000
  Train Loss: 0.6367 Acc: 0.9243
  No improvement in loss for 1 epochs.
Epoch 22/200
----------
  Batch 0: Loss: 0.5955, Acc: 0.9375
  Batch 20: Loss: 0.6775, Acc: 0.8750
  Train Loss: 0.6333 Acc: 0.9164
Epoch 23/200
----------

Running with the following configuration:
Root directory: /Users/pepe/carrera/3/2/vca/practicas/p2
Data Augmentation: True
Docked classification: True
Not training model: False
Training data ratio: 0.8
Pretrained: True
Model path: modelParams
Loading pretrained model: False
Class balancing: Balanced
Batch size: 16
Number of workers: 8
Number of epochs: 200
Early stopping patience: 8
Learning rate: 0.0001
L2 regularization lambda: 0.0
Learning rate decay patience: 4
Test images: []


--
Class counts before balancing: Counter({2: 151, 1: 144, 0: 88})
weights for balancing: Counter({0.006622516556291391: 151, 0.006944444444444444: 144, 0.011363636363636364: 88})
--

Using device: MPS
Epoch 1/200
----------
  Batch 0: Loss: 1.1211, Acc: 0.1875
  Batch 20: Loss: 1.0291, Acc: 0.7500
  Train Loss: 1.0773 Acc: 0.4700
Epoch 2/200
----------
  Batch 0: Loss: 1.0582, Acc: 0.6250
  Batch 20: Loss: 1.0648, Acc: 0.4375
  Train Loss: 1.0029 Acc: 0.6710
Epoch 3/200
----------
  Batch 0: Loss: 0.9782, Acc: 0.6250
  Batch 20: Loss: 0.8648, Acc: 0.8750
  Train Loss: 0.9203 Acc: 0.7337
Epoch 4/200
----------
  Batch 0: Loss: 0.8590, Acc: 0.6875
  Batch 20: Loss: 0.8480, Acc: 0.7500
  Train Loss: 0.8545 Acc: 0.7728
Epoch 5/200
----------
  Batch 0: Loss: 0.9164, Acc: 0.5625
  Batch 20: Loss: 0.8161, Acc: 0.7500
  Train Loss: 0.7950 Acc: 0.8094
Epoch 6/200
----------
  Batch 0: Loss: 0.7248, Acc: 0.9375
  Batch 20: Loss: 0.6928, Acc: 0.8750
  Train Loss: 0.7596 Acc: 0.8460
Epoch 7/200
----------
  Batch 0: Loss: 0.7240, Acc: 0.9375
  Batch 20: Loss: 0.8737, Acc: 0.6875
  Train Loss: 0.7391 Acc: 0.8407
Epoch 8/200
----------
  Batch 0: Loss: 0.8481, Acc: 0.6875
  Batch 20: Loss: 0.6262, Acc: 0.9375
  Train Loss: 0.7340 Acc: 0.8329
Epoch 9/200
----------
  Batch 0: Loss: 0.7221, Acc: 0.8750
  Batch 20: Loss: 0.6673, Acc: 0.8750
  Train Loss: 0.6824 Acc: 0.8930
Epoch 10/200
----------
  Batch 0: Loss: 0.6838, Acc: 0.9375
  Batch 20: Loss: 0.7390, Acc: 0.8125
  Train Loss: 0.6804 Acc: 0.8877
Epoch 11/200
----------
  Batch 0: Loss: 0.7516, Acc: 0.7500
  Batch 20: Loss: 0.6833, Acc: 0.8750
  Train Loss: 0.6720 Acc: 0.9060
Epoch 12/200
----------
  Batch 0: Loss: 0.6276, Acc: 0.9375
  Batch 20: Loss: 0.7051, Acc: 0.8750
  Train Loss: 0.6872 Acc: 0.8642
  No improvement in loss for 1 epochs.
Epoch 13/200
----------
  Batch 0: Loss: 0.6931, Acc: 0.8750
  Batch 20: Loss: 0.6316, Acc: 0.9375
  Train Loss: 0.6442 Acc: 0.9112
Epoch 14/200
----------
  Batch 0: Loss: 0.5984, Acc: 1.0000
  Batch 20: Loss: 0.6098, Acc: 1.0000
  Train Loss: 0.6516 Acc: 0.9191
  No improvement in loss for 1 epochs.
Epoch 15/200
----------
  Batch 0: Loss: 0.6366, Acc: 0.8750
  Batch 20: Loss: 0.6621, Acc: 0.8750
  Train Loss: 0.6573 Acc: 0.8903
  No improvement in loss for 2 epochs.
Epoch 16/200
----------
  Batch 0: Loss: 0.6236, Acc: 0.9375
  Batch 20: Loss: 0.6941, Acc: 0.8750
  Train Loss: 0.6319 Acc: 0.9243
Epoch 17/200
----------
  Batch 0: Loss: 0.7315, Acc: 0.8125
  Batch 20: Loss: 0.6142, Acc: 0.9375
  Train Loss: 0.6362 Acc: 0.9243
  No improvement in loss for 1 epochs.
Epoch 18/200
----------
  Batch 0: Loss: 0.7642, Acc: 0.8125
  Batch 20: Loss: 0.6563, Acc: 0.8750
  Train Loss: 0.6484 Acc: 0.9086
  No improvement in loss for 2 epochs.
Epoch 19/200
----------
  Batch 0: Loss: 0.6516, Acc: 0.9375
  Batch 20: Loss: 0.6123, Acc: 0.9375
  Train Loss: 0.6503 Acc: 0.9034
  No improvement in loss for 3 epochs.
Epoch 20/200
----------
  Batch 0: Loss: 0.6316, Acc: 0.9375
  Batch 20: Loss: 0.6025, Acc: 0.9375
  Train Loss: 0.6318 Acc: 0.9269
Epoch 21/200
----------
  Batch 0: Loss: 0.6160, Acc: 0.9375
  Batch 20: Loss: 0.6035, Acc: 0.9375
  Train Loss: 0.6333 Acc: 0.9269
  No improvement in loss for 1 epochs.
Epoch 22/200
----------
  Batch 0: Loss: 0.6800, Acc: 0.8750
  Batch 20: Loss: 0.5618, Acc: 1.0000
  Train Loss: 0.6378 Acc: 0.9138
  No improvement in loss for 2 epochs.
Epoch 23/200
----------
  Batch 0: Loss: 0.5564, Acc: 1.0000
  Batch 20: Loss: 0.6724, Acc: 0.8750
  Train Loss: 0.6417 Acc: 0.9086
  No improvement in loss for 3 epochs.
Epoch 24/200
----------
  Batch 0: Loss: 0.6309, Acc: 0.9375
  Batch 20: Loss: 0.6785, Acc: 0.8750
  Train Loss: 0.6185 Acc: 0.9373
Epoch 25/200
----------
  Batch 0: Loss: 0.6147, Acc: 0.9375
  Batch 20: Loss: 0.6973, Acc: 0.8750
  Train Loss: 0.6215 Acc: 0.9373
  No improvement in loss for 1 epochs.
Epoch 26/200
----------
  Batch 0: Loss: 0.5717, Acc: 1.0000
  Batch 20: Loss: 0.5569, Acc: 1.0000
  Train Loss: 0.6274 Acc: 0.9243
  No improvement in loss for 2 epochs.
Epoch 27/200
----------
  Batch 0: Loss: 0.6731, Acc: 0.8750
  Batch 20: Loss: 0.5529, Acc: 1.0000
  Train Loss: 0.6208 Acc: 0.9373
  No improvement in loss for 3 epochs.
Epoch 28/200
----------
  Batch 0: Loss: 0.5772, Acc: 1.0000
  Batch 20: Loss: 0.5952, Acc: 1.0000
  Train Loss: 0.6198 Acc: 0.9399
  No improvement in loss for 4 epochs.
  Learning rate early stopping triggered after 28 epochs.
Epoch 29/200
----------
  Batch 0: Loss: 0.6702, Acc: 0.8750
  Batch 20: Loss: 0.6106, Acc: 0.9375
  Train Loss: 0.6209 Acc: 0.9321
  No improvement in loss for 5 epochs.
  Learning rate early stopping triggered after 29 epochs.
Epoch 30/200
----------
  Batch 0: Loss: 0.6336, Acc: 0.9375
  Batch 20: Loss: 0.6281, Acc: 0.9375
  Train Loss: 0.6155 Acc: 0.9399
Epoch 31/200
----------
  Batch 0: Loss: 0.7674, Acc: 0.8125
  Batch 20: Loss: 0.7335, Acc: 0.8125
  Train Loss: 0.6245 Acc: 0.9321
  No improvement in loss for 1 epochs.
Epoch 32/200
----------
  Batch 0: Loss: 0.5750, Acc: 1.0000
  Batch 20: Loss: 0.6341, Acc: 0.9375
  Train Loss: 0.6014 Acc: 0.9556
Epoch 33/200
----------
  Batch 0: Loss: 0.5910, Acc: 0.9375
  Batch 20: Loss: 0.6572, Acc: 0.9375
  Train Loss: 0.6092 Acc: 0.9530
  No improvement in loss for 1 epochs.
Epoch 34/200
----------
  Batch 0: Loss: 0.6763, Acc: 0.8750
  Batch 20: Loss: 0.6271, Acc: 0.9375
  Train Loss: 0.6167 Acc: 0.9373
  No improvement in loss for 2 epochs.
Epoch 35/200
----------
  Batch 0: Loss: 0.5883, Acc: 0.9375
  Batch 20: Loss: 0.5594, Acc: 1.0000
  Train Loss: 0.6229 Acc: 0.9321
  No improvement in loss for 3 epochs.
Epoch 36/200
----------
  Batch 0: Loss: 0.5591, Acc: 1.0000
  Batch 20: Loss: 0.6508, Acc: 0.8750
  Train Loss: 0.6272 Acc: 0.9295
  No improvement in loss for 4 epochs.
  Learning rate early stopping triggered after 36 epochs.
Epoch 37/200
----------
  Batch 0: Loss: 0.5589, Acc: 1.0000
  Batch 20: Loss: 0.5560, Acc: 1.0000
  Train Loss: 0.5793 Acc: 0.9791
Epoch 38/200
----------
  Batch 0: Loss: 0.6765, Acc: 0.8750
  Batch 20: Loss: 0.6093, Acc: 0.9375
  Train Loss: 0.6185 Acc: 0.9295
  No improvement in loss for 1 epochs.
Epoch 39/200
----------
  Batch 0: Loss: 0.5606, Acc: 1.0000
  Batch 20: Loss: 0.6735, Acc: 0.8750
  Train Loss: 0.6198 Acc: 0.9321
  No improvement in loss for 2 epochs.
Epoch 40/200
----------
  Batch 0: Loss: 0.5909, Acc: 0.9375
  Batch 20: Loss: 0.6838, Acc: 0.8750
  Train Loss: 0.6059 Acc: 0.9478
  No improvement in loss for 3 epochs.
Epoch 41/200
----------
  Batch 0: Loss: 0.5564, Acc: 1.0000
  Batch 20: Loss: 0.6064, Acc: 0.9375
  Train Loss: 0.6060 Acc: 0.9478
  No improvement in loss for 4 epochs.
  Learning rate early stopping triggered after 41 epochs.
Epoch 42/200
----------
  Batch 0: Loss: 0.5550, Acc: 1.0000
  Batch 20: Loss: 0.5527, Acc: 1.0000
  Train Loss: 0.5974 Acc: 0.9608
  No improvement in loss for 5 epochs.
  Learning rate early stopping triggered after 42 epochs.
Epoch 43/200
----------
  Batch 0: Loss: 0.5543, Acc: 1.0000
  Batch 20: Loss: 0.7332, Acc: 0.8125
  Train Loss: 0.6043 Acc: 0.9582
  No improvement in loss for 6 epochs.
  Learning rate early stopping triggered after 43 epochs.
Epoch 44/200
----------
  Batch 0: Loss: 0.5826, Acc: 1.0000
  Batch 20: Loss: 0.5860, Acc: 1.0000
  Train Loss: 0.6048 Acc: 0.9530
  No improvement in loss for 7 epochs.
  Learning rate early stopping triggered after 44 epochs.
Epoch 45/200
----------
  Batch 0: Loss: 0.6509, Acc: 0.8750
  Batch 20: Loss: 0.7295, Acc: 0.8125
  Train Loss: 0.6170 Acc: 0.9321
  No improvement in loss for 8 epochs.
  Learning rate early stopping triggered after 45 epochs.
  Early stopping triggered after 45 epochs.
Training completed in 59m 27s
Final Accuracy: 0.9321
Using device: MPS
Test Accuracy: 0.8644
F1 Score: 0.8468
Model saved to modelParams
